<head>
<script type="module">
  import { GitHubHandler } from './GitHubHandler.js';

  const owner = localStorage.getItem('OWNER');
  const repo = localStorage.getItem('REPO');
  const token = localStorage.getItem('TOKEN');


  function clearColumns() {
    document.getElementById('in-dev').innerHTML = "In Dev | "
    document.getElementById('review').innerHTML = "Review | "
    document.getElementById('awaiting-merge').innerHTML = "Awaiting Merge | "
  }

  function drawColumns() {
    clearColumns();
    gitHubHandler.branches.forEach((branch) => {
      if (branch.location == "DEV") {
        document.getElementById('in-dev').innerHTML += "<div>" + branch.name + "</div>"
      } else if (branch.location == "PR") {
        document.getElementById('review').innerHTML += "<div>" + branch.name + "</div>"
      } else if (branch.location == "AM") {
        document.getElementById('awaiting-merge').innerHTML += "<div>" + branch.name + "</div>"
      }
    })
  }

  const gitHubHandler = new GitHubHandler(owner, repo, token, drawColumns);

  try {
    gitHubHandler.getBranches()
      .then(() => gitHubHandler.getPullRequests())
      .then(() => {drawColumns()})
    ;


  } catch (error) {
    console.log(`Error! Status: ${error.status}. Message: ${error.response.data.message}`)
  }

</script>
</head>
<body>
<div>Hello World!</div>
<div id='todo'>Todo</div>
<br />
<div id='in-dev'>In Dev | </div>
<br />
<div id='review'> | </div>
<br />
<div id='awaiting-merge'>Awaiting Merge</div>
<br />
<div id='done'>Done</div>
</body>
